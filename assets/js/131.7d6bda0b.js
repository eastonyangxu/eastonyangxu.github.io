(window.webpackJsonp=window.webpackJsonp||[]).push([[131],{637:function(s,n,e){"use strict";e.r(n);var a=e(4),t=Object(a.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"系统服务管理器指令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#系统服务管理器指令"}},[s._v("#")]),s._v(" 系统服务管理器指令")]),s._v(" "),n("h3",{attrs:{id:"服务器路径"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#服务器路径"}},[s._v("#")]),s._v(" 服务器路径")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("/usr/lib/systemd/system\n\n该路径下文件名以 .service 结尾。\n查看mongod.service：systemctl status mongod 或者 systemctl status mongod.service\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h3",{attrs:{id:"systemctl-常用命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#systemctl-常用命令"}},[s._v("#")]),s._v(" systemctl 常用命令")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("start 启动\nstop 停止\nstatus 查看状态\nreload 加载文件\nrestart 重启\n\n具体的详细情况可以查看帮助：systemctl -h\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h2",{attrs:{id:"文件详解"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#文件详解"}},[s._v("#")]),s._v(" 文件详解")]),s._v(" "),n("h3",{attrs:{id:"_1-unit"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-unit"}},[s._v("#")]),s._v(" 1. Unit")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("所有 Unit 文件通用, 该部分主要是对这个服务的说明，以及配置与其他服务的关系。\n参数详解如下：\n\nDescription ： 一段描述这个 Unit 文件的文字，通常只是简短的一句话。\n\nDocumentation：指定服务的文档，可以是一个或多个文档的URL路径。\n\nRequires：依赖的其他 Unit 列表，列在其中的 Unit 模块会在这个服务启动的同时被启动，并且如果其中有任意一个服务启动失败，这个服务也会被终止\n\nAfter：与 Requires 相似，但会在后面列出的所有模块全部启动完成以后，才会启动当前的服务。\n\nBefore：与 After 相反，在启动指定的任一个模块之前，都会首先确保当前服务已经运行。\n注意：Before=, After=　是配置服务间的启动顺序，比如一个 foo.service 包含了一行 Before=bar.service，那么当他们同时启动时，bar.service 会等待 foo.service 启动完成后才启动。注意这个设置和 Requires= 的相互独立的，同时包含 After= 和 Requires= 也是常见的。此选项可以指定多次，然后按顺序全部启动\n\nWants：与 Requires 相似，但只是在被配置的这个 Unit 启- 动时，触发启动列出的每个 Unit 模块，而不去考虑这些模块启动是否成功。\n\nConflicts：与这个模块有冲突的模块，如果列出模块中有已经在运行的，这个服务就不能启动，反之亦然。\n注意：如果这里列出的服务启动，那么本服务就会停止，反之亦然 ，即后启动的才起作用。注意，此设置和 After= 和 Before= 是互相独立的。\n\nOnFailure：当这个模块启动失败时，就自动启动列出的每个模块。\n\nPartOf ：该参数仅作用于单元的停止或重启。其含义是，当停止或重启这里列出的某个单元时， 也会同时停止或重启该单元自身。 注意，这个依赖是单向的， 该单元自身的停止或重启并不影响这里列出的单元。如果 a.service 中包含了 PartOf=b.service ，那么这个依赖关系将在 b.service 的属性列表中显示为 ConsistsOf=a.service 。 也就是说，不能直接设置 ConsistsOf= 依赖。\n\n@ ： Linux 上配置过 openvpn 的同学应该都看到过一些 openvpn@client.service 这样的例子：\n若需在系统启动时自动启动 OpenVPN，对服务器端与客户端，都可以采用在对应机器上 启用 openvpn@.service 的方式配置。例如，如果客户端配置文件是 /etc/openvpn/client.conf，则服务名称应为 openvpn@client.service。或者，如果服务器端配置文件是 /etc/openvpn/server.conf，则服务名称应为 openvpn@server.service。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br")])]),n("h3",{attrs:{id:"_2-service"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-service"}},[s._v("#")]),s._v(" 2. Service")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("Type：\n设置进程的启动类型。必须设为 simple, exec, forking, oneshot, dbus, notify, idle 之一，默认的 simple 类型可以适应于绝大多数的场景，因此一般可以忽略这个参数的配置。而如果服务程序启动后会通过 fork 系统调用创建子进程，然后关闭应用程序本身进程的情况，则应该将 Type 的值设置为 forking，否则 systemd 将不会跟踪子进程的行为，而认为服务已经退出。其他类型说明见文章附录\n\nEnvironment： 为服务添加环境变量\n\nEnvironmentFile：指定加载一个包含服务所需的环境参数的文件，文件中的每一行都是一个环境变量的定义。\n\nExecStart：这个参数是几乎每个 .service 文件都会有的，指定服务启动的主要命令，在每个配置文件中只能使用一次。需要使用绝对路径\n\nExecStartPre：指定在启动执行 ExecStart 的命令前的准备工作，可以有多个，所有命令会按照文件中书写的顺序依次被执行。\n\nExecStartPost： 指定在启动执行 ExecStart 的命令后的收尾工作，也可以有多个。\n\nExecStop： 停止服务所需要执行的主要命令。需要使用绝对路径\n\nExecStopPost：指定在 ExecStop 命令执行后的收尾工作，也可以有多个。\n\nExecReload：重新加载服务文件所需执行的主要命令。需要使用绝对路径\n\nRestart:这个值用于指定在什么情况下需要重启服务进程，这些不同的值分别表示了在哪些情况下，服务会被重新启动，\nno（默认值）：退出后不会重启\nalways：除了用systemctl stop 或等价的服务停止操作命令，其他情况都可以重启\non-success：只有正常退出时（退出状态码为0），才会重启\non-failure：非正常退出时（退出状态码非0），包括被信号终止和超时，才会重启（守护进程，推荐值）\non-abnormal：只有被信号终止和超时，才会重启（对于允许发生错误退出的服务，推荐值）\non-abort：只有在收到没有捕捉到的信号终止时，才会重启\non-watchdog：超时退出，才会重启\n\nRestartSec: 如果服务需要被重启，这个参数的值为服务被重启前的等待秒数。注意，该重启等待时间只针对上面Restart的参数值起作用时的重启才有效，比如说：因Unit段配置的关系或者人为使用systemctl restart命令导致该服务重启时，该参数无效，会马上重启\n\nNice:服务的进程优先级，值越小优先级越高，默认为0。-20为最高优先级，19为最低优先级。\n\nWorkingDirectory:指定服务的工作目录。\n\nRootDirectory:指定服务进程的根目录（ / 目录），如果配置了这个参数后，服务将无法访问指定目录以外的任何文件。\n\nUser:指定运行服务的用户，会影响服务对本地文件系统的访问权限。可使用root\n\nGroup:指定运行服务的用户组，会影响服务对本地文件系统的访问权限。\n\nPrivateTmp:是否给服务分配独立的临时空间（true/false）\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br")])]),n("h3",{attrs:{id:"_3-install"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-install"}},[s._v("#")]),s._v(" 3. Install")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("Install段是服务的安装信息，它不在 systemd 的运行期间使用，只在使用 systemctl enable 和 systemctl disable 命令启用/禁用服务时有用，所有 Unit 文件通用，用来定义如何启动，以及是否开机启动，参数详解如下：\n\nWantedBy：它的值是一个或多个 target，执行enable命令时，符号链接会放入/etc/systemd/system目录下以\ntarget 名 + .wants后缀构成的子目录中。“WantedBy=multi-user.target” 表明当系统以多用户方式（默认的运行级别）启动时，这个服务需要被自动运行。当然还需要 systemctl enable 激活这个服务以后自动运行才会生效\n\nRequiredBy：依赖当前服务的模块。它的值是一个或多个 target，执行enable命令时，符号链接会放入/etc/systemd/system目录下以 target 名 + .required后缀构成的子目录中\n\nAlias：当前 Unit 可用于启动的别名\n\nAlso：当前 Unit 被 enable/disable 时，会被同时操作的其他 Unit\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h2",{attrs:{id:"参考"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://blog.csdn.net/weixin_45606237/article/details/124727920",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考来源"),n("OutboundLink")],1)])])}),[],!1,null,null,null);n.default=t.exports}}]);